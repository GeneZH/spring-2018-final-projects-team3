<!DOCTYPE html>
<html>

<head>
    <title>Project 3</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"></link>
    <link rel="stylesheet" type="text/css" href="finalproject.css"></link>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <script src="https://d3js.org/d3.v4.min.js"></script>
    <script async defer
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDu1gZ0iuhX8XWlJQJL6q8HQ_GsF9YiFcE&callback=initMap">
    </script>
</head>

<body>
    <nav class="navbar navbar-inverse navbar-fixed-top">
        <div class="container-fluid">
            <div class="navbar-header">
                <p class="navbar-brand" href="#">Final Project</p>
            </div>
        </div>
    </nav>
    <div id="map" style="margin-top: 70px; margin-bottom: 10px;">

    </div>
    <script>
    // $('#mapLink').click(function() { scrollTo("map"); return false; });
    // $('#vis1Link').click(function() { scrollTo("Vis1"); return false; });
    // $('#vis2Link').click(function() { scrollTo("Vis2"); return false; });
    //
    // function scrollTo(id) {
    //     $('html,body').animate({
    //             scrollTop: $("#" + id).offset().top - 80
    //         },
    //         'slow');
    // }
    function initMap() {
        var denver_cord = {lat: 39.754136, lng: -105.001440};
        var map = new google.maps.Map(document.getElementById('map'), {
            zoom: 20,
            center: denver_cord
          });

        //draw bus routes
        var directionsService = new google.maps.DirectionsService();
        var start = [{lat: 40.017105,lng:  -105.276563}];
        var end = [{lat: 39.7552, lng: -105.00255 }];
       
        for(var i = 0; i < start.length; i++) {
            console.log(start[i]);
            requestDirections(start[i], end[i]);
        }

        //draw realtime bus
        bus_cord = [{lat:  39.98578,lng:   -105.23454}];
        displayBus(bus_cord[0])

        function renderDirections(result, status) {
          var directionsRenderer = new google.maps.DirectionsRenderer();
          directionsRenderer.setMap(map);
          if (status == 'OK') {
             directionsRenderer.setDirections(result);
          }
        }

        /*  Route FF2
        40.017105, -105.276563

        40.005428, -105.27168
        40.003173, -105.267222
        39.999344, -105.263297
        39.989015, -105.25559
        39.985739, -105.247903
        39.98578, -105.23454
        39.958022, -105.168041
        39.759506, -104.994238

        39.7552, -105.00255
        */
       
        var wp = [
            {
                location: {lat: 40.005428,lng:  -105.27168},
                stopover: true
            },
            {
                 location: {lat: 40.003173,lng:  -105.267222},
                 stopover: true
            },
            {
                location: {lat: 39.999344,lng:  -105.263297},
                stopover: true
            },
            {
                 location: {lat: 39.989015,lng:  -105.25559},
                 stopover: true
            },
            {
                location: {lat: 39.985739,lng:  -105.247903},
                stopover: true
            },
            {
                 location: {lat:  39.98578,lng:   -105.23454},
                 stopover: true
            },
            {
                location: {lat: 39.958022,lng:  -105.168041},
                stopover: true
            },
            {
                location: {lat: 39.759506,lng:  -104.994238},
                stopover: true
            }
            ];

        function requestDirections(start, end) {
          directionsService.route({
            origin: start,
            destination: end,
            travelMode: 'TRANSIT',
            waypoints: wp,
            transitOptions: {
              modes: ['BUS'],
            }
          }, function(result, status) {
            renderDirections(result, status);
          });
        }

        function displayBus(bus_cord) {
            icon = 'bus.png';
            features = [{
                position: bus_cord,
                type: 'info'
            }];
            // Create markers.
            features.forEach(function(feature) {
              var marker = new google.maps.Marker({
                position: feature.position,
                icon: icon,
                map: map
              });
            });
        }
    }


    </script>
    <footer class="navbar navbar-inverse navbar-static-bottom">
        <center class="navbar-brand">Team 3:</center>
        <center class="navbar-brand">Chih-Wei Lin</center>
        <center class="navbar-brand">Yijun Zhang</center>
        <center class="navbar-brand">Yuhan Lin</center>
    </footer>
</body>

</html>
